define(["component","text!templet/reviewView.html","text!templet/reviewContentView.html","view/calendar_window_eventSaveView","view/calendar_window_eventView"],function(e,t,n){app.views.review=Backbone.View.extend({el:"#workspace",events:{"click dl a.fc-event":"onClickEvent"},onClickEvent:function(t){var n=$(t.currentTarget).parents("span.relation"),r=JSON.parse(decodeURIComponent(n.attr("data-body"))),i=new app.models.event({id:r.ID,id_user:r.ID_USER,name:r.BODY_NAME,start:r.BODY_START,end:r.BODY_END,intro:r.BODY_INTRO,className:r.BODY_CLASS,permission:r.BODY_PERMISSION,is_done:r.IS_DONE});r.ID_USER==app.instances.models.user.get("id")?(e.component_window(null),(new app.views.calendar_window_eventSave(i)).render()):(e.component_window(null),(new app.views.calendar_window_event(i)).render())},renderLoading:function(){$(".mainContainer_body").html($("#span_loading").html())},renderLogs:function(t){app.instances.views.review.renderLoading();var r=moment(moment(t).format("YYYY-MM-DD")).unix(),i=_.template(n);$(".mainContainer_head").html(moment(t).format("YYYY-MM-DD")),app.instances.views.review.fechXhr&&app.instances.views.review.fechXhr.readyState>0&&app.instances.views.review.fechXhr.readyState<4&&app.instances.views.review.fechXhr.abort(),app.instances.views.review.fechXhr=e.api_call("/api/records","GET",{TIMESTAMP:r},function(e){app.instances.views.review&&(e.response.length?$(".mainContainer_body").html(i({list:e.response})):$(".mainContainer_body").html($("#span_null").html()))})},render:function(){this.template=_.template(t),this.$el.html(this.template());var e="en";return localStorage.getItem("locale")=="zh-cn"&&(e="ch"),$("#dateSelector").datetimepicker({inline:!0,lang:e,timepicker:!1,format:"Y-m-d",onGenerate:this.renderLogs}),this}})});